(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[898],{42480:function(){},5129:function(t,e,s){Promise.resolve().then(s.t.bind(s,65878,23)),Promise.resolve().then(s.bind(s,81523)),Promise.resolve().then(s.bind(s,70049)),Promise.resolve().then(s.bind(s,41180))},41180:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return g}});var o=s(57437),i=s(2265),a=s(78796),n=s(29501),r=s(71096),l=s.n(r),d=s(80605),c=s(89427),u=s(71134),p=s(99376),_=s(25957),f=s(76725),m=s(43118),v=s(83930);function g(){let{data:t}=(0,d.useSession)(),[e,s]=i.useState(!1),{dataPost:r,setDataPost:g}=(0,v.k)(),{setIsModalMedia:h,isOpenFeatureImage:b,openFeatureImage:x,closeFeatureImage:y,setSeletectedImage:j,closeMedia:S,seletectedImage:C,setFocalPoint:k,focalPoint:q}=(0,_.G)(),E=(0,p.useRouter)(),{register:N,handleSubmit:w,formState:{errors:P},setValue:Y,control:A,trigger:z,reset:D,watch:I}=(0,n.cI)(),M=(0,n.qo)({control:A,name:"post_title"}),H=(0,a.p)(),U=(0,p.useSearchParams)(),Z=(0,m.A)(U.get("aa"))||"",F=async e=>{var o;s(!0),e.post_date=l()().format("YYYY-MM-DD HH:mm:ss"),e.post_publish_date="1970-01-01 23:59:59",e.post_original_date=l()().format("YYYY-MM-DD HH:mm:ss"),e.post_status=[e.post_status],e.post_author=t.user.username,e.post_tag=e.post_tag.map(t=>t.label),e.is_premium=0,e.partner_id=1,e.post_video_url="",e.post_gallery="",e.post_modified="",e.feat_img_size={small:{x:null==q?void 0:q.x.toString(),y:null==q?void 0:q.y.toString()},medium:{x:"",y:""},full:{x:"",y:""}},e.post_editor=null==r?void 0:r.post_editor,e.post_source=0,e.post_canonical_link="",e.is_ghost=0,e.post_enclosure_link="",e.post_title_masking="";let i=await (0,c.Z)("PUT","".concat("http://10.177.2.133:3037/uzcms-odcdc/","api/v1/articles/?article_id=").concat(Z),e,{accept:"application/json",Authorization:"Bearer ".concat(null==t?void 0:null===(o=t.user)||void 0===o?void 0:o.access_token)});(null==i?void 0:i.status)==200?(s(!1),H({title:"Success",description:"Data has been updated",status:"success",duration:6e3,isClosable:!0,position:"top"}),"publish"==e.post_status?E.push("/dashboard/post/list"):E.push("/dashboard/post/draft")):(s(!1),H({title:"Failed to create data",description:i.data.detail.map(t=>"".concat(t.loc.join(" -> "),": ").concat(t.msg)).join(", "),status:"error",duration:7e3,isClosable:!0,position:"top"}))};return N("post_content",{required:"Content is required"}),N("post_tag",{required:"Tag is required"}),N("post_category",{required:"Category is required"}),N("post_publisher",{required:"publish on is required"}),i.useEffect(()=>{M&&Y("post_slug",M.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,""))},[M,Y]),i.useEffect(()=>{let e=async()=>{var e,s,o,i,a,n,r;let l=await (0,c.Z)("GET","".concat("http://10.177.2.133:3037/uzcms-odcdc/","api/v1/articles/"),{id:Z},{accept:"application/json",Authorization:"Bearer ".concat(null==t?void 0:null===(e=t.user)||void 0===e?void 0:e.access_token)});if((null==l?void 0:l.status)==200){let t=null==l?void 0:null===(s=l.data)||void 0===s?void 0:s.data;t.post_publisher=[...t.post_publisher,"1"],g(t),D(t),j(null==l?void 0:null===(i=l.data)||void 0===i?void 0:null===(o=i.data)||void 0===o?void 0:o.feature_img),k(null==l?void 0:null===(r=l.data)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:null===(a=n.feat_img_size)||void 0===a?void 0:a.small)}};t&&e()},[t]),i.useEffect(()=>{y(),S()},[]),(0,o.jsxs)("div",{className:"px-4 pt-6",children:[(0,o.jsx)(u.Z,{register:N,isOpen:b,onClose:y,setValue:Y}),(0,o.jsx)("div",{className:"flex items-center mb-4 lg:mb-0",children:(0,o.jsx)("h3",{className:"mb-2 text-xl font-bold text-gray-900 dark:text-white",children:"Edit Post"})}),(0,o.jsx)("div",{className:"",children:(0,o.jsx)("form",{onSubmit:w(F),autoComplete:"off",className:"grid grid-cols-1 gap-2 lg:grid-cols-3",children:r?(0,o.jsx)(f.Z,{register:N,errors:P,session:t,control:A,trigger:z,setValue:Y,isLoading:e,setIsModalMedia:h,openFeatureImage:x,seletectedImage:C,Controller:n.Qr,watch:I,useFieldArray:n.Dq}):(0,o.jsx)("div",{className:"flex justify-center",children:"Loading..."})})})]})}},43118:function(t,e,s){"use strict";s.d(e,{A:function(){return n},P:function(){return a}});var o=s(80928),i=s.n(o);function a(t){return encodeURIComponent(i().AES.encrypt(t.toString(),"c2c9cfa669c5a7fd065c694e3c112f1aec09401e895ad77f72255158b9847d58").toString())}function n(t){return i().AES.decrypt(decodeURIComponent(t),"c2c9cfa669c5a7fd065c694e3c112f1aec09401e895ad77f72255158b9847d58").toString(i().enc.Utf8)}}},function(t){t.O(0,[4565,7699,6051,5706,9956,1779,7240,296,5878,1445,1760,9799,6434,3464,9355,7730,7676,9611,5691,629,316,7987,1721,8479,2971,2117,1744],function(){return t(t.s=5129)}),_N_E=t.O()}]);