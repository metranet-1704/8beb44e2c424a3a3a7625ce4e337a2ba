(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[898],{42480:function(){},5129:function(t,e,o){Promise.resolve().then(o.t.bind(o,65878,23)),Promise.resolve().then(o.bind(o,81523)),Promise.resolve().then(o.bind(o,70049)),Promise.resolve().then(o.bind(o,41180))},41180:function(t,e,o){"use strict";o.r(e),o.d(e,{default:function(){return g}});var a=o(57437),s=o(2265),i=o(78796),n=o(29501),l=o(71096),r=o.n(l),d=o(80605),c=o(89427),u=o(71134),p=o(99376),v=o(25957),m=o(76725),f=o(43118),_=o(83930);function g(){let{data:t}=(0,d.useSession)(),[e,o]=s.useState([]),[l,g]=s.useState(!1),[h,b]=s.useState({}),{setDataPost:x}=(0,_.k)(),{setIsModalMedia:y,isOpenFeatureImage:S,openFeatureImage:j,closeFeatureImage:C,setSeletectedImage:k,closeMedia:E,seletectedImage:q,setFocalPoint:N,focalPoint:w}=(0,v.G)(),z=(0,p.useRouter)(),{register:P,handleSubmit:Y,formState:{errors:A},setValue:I,control:M,trigger:D,reset:Z}=(0,n.cI)(),H=(0,n.qo)({control:M,name:"post_title"}),T=(0,i.p)(),U=(0,p.useSearchParams)(),B=(0,f.A)(U.get("aa"))||"",G=async e=>{var o;g(!0),e.post_date=r()().format("YYYY-MM-DD HH:mm:ss"),e.post_publish_date="1970-01-01 23:59:59",e.post_original_date=r()().format("YYYY-MM-DD HH:mm:ss"),e.post_status=[e.post_status],e.post_author=t.user.username,e.post_tag=e.post_tag.map(t=>t.label),e.is_premium=0,e.partner_id=1,e.post_video_url="",e.post_gallery="",e.post_modified="",e.feat_img_size={small:{x:null==w?void 0:w.x.toString(),y:null==w?void 0:w.y.toString()},medium:{x:"",y:""},full:{x:"",y:""}},e.post_publisher=[""],e.post_editor=0,e.post_source=0,e.post_canonical_link="",e.is_ghost=0,e.post_enclosure_link="",e.post_title_masking="";let a=await (0,c.Z)("PUT","".concat("http://10.177.2.133:3037/uzcms-odcdc/","api/v1/articles/?article_id=").concat(B),e,{accept:"application/json",Authorization:"Bearer ".concat(null==t?void 0:null===(o=t.user)||void 0===o?void 0:o.access_token)});(null==a?void 0:a.status)==200?(g(!1),T({title:"Success",description:"Data has been updated",status:"success",duration:6e3,isClosable:!0,position:"top"}),"publish"==e.post_status?z.push("/dashboard/post/list"):z.push("/dashboard/post/draft")):(g(!1),T({title:"Failed to create data",description:a.data.detail.map(t=>"".concat(t.loc.join(" -> "),": ").concat(t.msg)).join(", "),status:"error",duration:7e3,isClosable:!0,position:"top"}))};return P("post_content",{required:"Content is required"}),P("post_tag",{required:"Tag is required"}),P("post_category",{required:"Category is required"}),P("post_publisher",{required:"publish on is required"}),s.useEffect(()=>{H&&I("post_slug",H.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,""))},[H,I]),s.useEffect(()=>{let e=async()=>{var e,a;let s=await (0,c.Z)("GET","".concat("http://10.177.2.133:3037/uzcms-odcdc/","api/v1/article-categories/"),{page:1,limit:100},{accept:"application/json",Authorization:"Bearer ".concat(null==t?void 0:null===(e=t.user)||void 0===e?void 0:e.access_token)});(null==s?void 0:s.status)==200&&o(null==s?void 0:null===(a=s.data)||void 0===a?void 0:a.data)};t&&e()},[t]),s.useEffect(()=>{let o=async()=>{var e,o,a,s,i,n,l,r,d;let u=await (0,c.Z)("GET","".concat("http://10.177.2.133:3037/uzcms-odcdc/","api/v1/articles/"),{id:B},{accept:"application/json",Authorization:"Bearer ".concat(null==t?void 0:null===(e=t.user)||void 0===e?void 0:e.access_token)});(null==u?void 0:u.status)==200&&(x(null==u?void 0:null===(o=u.data)||void 0===o?void 0:o.data),b(null==u?void 0:null===(a=u.data)||void 0===a?void 0:a.data),Z(null==u?void 0:null===(s=u.data)||void 0===s?void 0:s.data),k(null==u?void 0:null===(n=u.data)||void 0===n?void 0:null===(i=n.data)||void 0===i?void 0:i.feature_img),N(null==u?void 0:null===(d=u.data)||void 0===d?void 0:null===(r=d.data)||void 0===r?void 0:null===(l=r.feat_img_size)||void 0===l?void 0:l.small))};e.length>0&&o()},[e]),s.useEffect(()=>{C(),E()},[]),(0,a.jsxs)("div",{className:"px-4 pt-6",children:[(0,a.jsx)(u.Z,{register:P,isOpen:S,onClose:C,setValue:I}),(0,a.jsx)("div",{className:"flex items-center mb-4 lg:mb-0",children:(0,a.jsx)("h3",{className:"mb-2 text-xl font-bold text-gray-900 dark:text-white",children:"Edit Post"})}),(0,a.jsx)("div",{className:"",children:(0,a.jsx)("form",{onSubmit:Y(G),autoComplete:"off",className:"grid grid-cols-1 gap-2 lg:grid-cols-3",children:h?(0,a.jsx)(m.Z,{register:P,errors:A,session:t,dataCategory:e,control:M,trigger:D,setValue:I,isLoading:l,setIsModalMedia:y,openFeatureImage:j,seletectedImage:q,Controller:n.Qr}):(0,a.jsx)("div",{className:"flex justify-center",children:"Loading..."})})})]})}},43118:function(t,e,o){"use strict";o.d(e,{A:function(){return n},P:function(){return i}});var a=o(80928),s=o.n(a);function i(t){return encodeURIComponent(s().AES.encrypt(t.toString(),"c2c9cfa669c5a7fd065c694e3c112f1aec09401e895ad77f72255158b9847d58").toString())}function n(t){return s().AES.decrypt(decodeURIComponent(t),"c2c9cfa669c5a7fd065c694e3c112f1aec09401e895ad77f72255158b9847d58").toString(s().enc.Utf8)}}},function(t){t.O(0,[4565,7699,6051,5706,9956,1779,7240,296,5878,1445,1760,9799,6434,3464,9355,7730,7676,9611,5691,629,316,123,1721,8479,2971,2117,1744],function(){return t(t.s=5129)}),_N_E=t.O()}]);