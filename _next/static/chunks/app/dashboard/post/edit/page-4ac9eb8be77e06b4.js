(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[898],{42480:function(){},5129:function(e,t,s){Promise.resolve().then(s.t.bind(s,65878,23)),Promise.resolve().then(s.bind(s,81523)),Promise.resolve().then(s.bind(s,70049)),Promise.resolve().then(s.bind(s,41180))},41180:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var o=s(57437),i=s(2265),a=s(78796),r=s(29501),n=s(71096),l=s.n(n),c=s(80605),u=s(89427),d=s(71134),p=s(99376),_=s(25957),f=s(76725),m=s(43118),g=s(83930);function h(){let{data:e}=(0,c.useSession)(),[t,s]=i.useState(!1),{dataPost:n,setDataPost:h}=(0,g.k)(),{setIsModalMedia:v,isOpenFeatureImage:b,openFeatureImage:x,closeFeatureImage:y,setSeletectedImage:j,closeMedia:S,seletectedImage:C,setFocalPoint:k,focalPoint:q,setGallery:E}=(0,_.G)(),N=(0,p.useRouter)(),{register:w,handleSubmit:P,formState:{errors:Y},setValue:A,control:z,trigger:D,reset:I,watch:M}=(0,r.cI)(),H=(0,r.qo)({control:z,name:"post_title"}),U=(0,a.p)(),Z=(0,p.useSearchParams)(),F=(0,m.A)(Z.get("aa"))||"",L=async t=>{var o;s(!0),t.post_date=l()().format("YYYY-MM-DD HH:mm:ss"),t.post_publish_date="1970-01-01 23:59:59",t.post_original_date=l()().format("YYYY-MM-DD HH:mm:ss"),t.post_status=[t.post_status],t.post_author=e.user.username,t.post_tag=t.post_tag.map(e=>e.label),t.is_premium=0,t.partner_id=1,t.post_video_url="",t.post_gallery=t.post_gallery||[],t.post_modified="",t.feat_img_size={small:{x:null==q?void 0:q.x.toString(),y:null==q?void 0:q.y.toString()},medium:{x:"",y:""},full:{x:"",y:""}},t.post_editor=null==n?void 0:n.post_editor,t.post_source=0,t.post_canonical_link="",t.is_ghost=0,t.post_enclosure_link="",t.post_title_masking="";let i=await (0,u.Z)("PUT","".concat("https://mercury.uzone.id/","api/v1/articles/?article_id=").concat(F),t,{accept:"application/json",Authorization:"Bearer ".concat(null==e?void 0:null===(o=e.user)||void 0===o?void 0:o.access_token)});(null==i?void 0:i.status)==200?(s(!1),U({title:"Success",description:"Data has been updated",status:"success",duration:6e3,isClosable:!0,position:"top"}),"publish"==t.post_status?N.push("/dashboard/post/list"):N.push("/dashboard/post/draft")):(s(!1),U({title:"Failed to create data",description:i.data.detail.map(e=>"".concat(e.loc.join(" -> "),": ").concat(e.msg)).join(", "),status:"error",duration:7e3,isClosable:!0,position:"top"}))};return w("post_content",{required:"Content is required"}),w("post_tag",{required:"Tag is required"}),w("post_category",{required:"Category is required"}),w("post_publisher",{required:"publish on is required"}),i.useEffect(()=>{H&&A("post_slug",H.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,""))},[H,A]),i.useEffect(()=>{let t=async()=>{var t,s,o;let i=await (0,u.Z)("GET","".concat("https://mercury.uzone.id/","api/v1/articles/"),{id:F},{accept:"application/json",Authorization:"Bearer ".concat(null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.access_token)});if((null==i?void 0:i.status)==200){let e=null==i?void 0:null===(s=i.data)||void 0===s?void 0:s.data;e.post_publisher=[...e.post_publisher,"1"],j(null==e?void 0:e.feature_img),k(null==e?void 0:null===(o=e.feat_img_size)||void 0===o?void 0:o.small),E(null==e?void 0:e.post_gallery),h(e),I(e)}};e&&t()},[e]),i.useEffect(()=>{y(),S()},[]),(0,o.jsxs)("div",{className:"px-4 pt-6",children:[(0,o.jsx)(d.Z,{register:w,isOpen:b,onClose:y,setValue:A}),(0,o.jsx)("div",{className:"flex items-center mb-4 lg:mb-0",children:(0,o.jsx)("h3",{className:"mb-2 text-xl font-bold text-gray-900 dark:text-white",children:"Edit Post"})}),(0,o.jsx)("div",{className:"",children:(0,o.jsx)("form",{onSubmit:P(L),autoComplete:"off",className:"grid grid-cols-1 gap-2 lg:grid-cols-3",children:n?(0,o.jsx)(f.Z,{register:w,errors:Y,session:e,control:z,trigger:D,setValue:A,isLoading:t,setIsModalMedia:v,openFeatureImage:x,seletectedImage:C,Controller:r.Qr,watch:M,useFieldArray:r.Dq}):(0,o.jsx)("div",{className:"flex justify-center",children:"Loading..."})})})]})}},43118:function(e,t,s){"use strict";s.d(t,{A:function(){return r},P:function(){return a}});var o=s(80928),i=s.n(o);function a(e){return encodeURIComponent(i().AES.encrypt(e.toString(),"c2c9cfa669c5a7fd065c694e3c112f1aec09401e895ad77f72255158b9847d58").toString())}function r(e){return i().AES.decrypt(decodeURIComponent(e),"c2c9cfa669c5a7fd065c694e3c112f1aec09401e895ad77f72255158b9847d58").toString(i().enc.Utf8)}}},function(e){e.O(0,[4565,7699,6051,9956,1779,7240,5706,296,9701,5878,605,3015,1760,9799,3464,9355,9611,1612,5506,2868,316,197,1721,8479,2971,2117,1744],function(){return e(e.s=5129)}),_N_E=e.O()}]);